#!/bin/sh

save_env() {
	cat <<-EOF > $GITOBLD_ENV
		ABUILD_CONTAINER=$ABUILD_CONTAINER

		APK_SERVER_CONTAINER=$APK_SERVER_CONTAINER
		APK_SERVER_HOST=$APK_SERVER_HOST

		GITOBLD_NETWORK=$GITOBLD_NETWORK
		GITOBLD_VOLUME=$GITOBLD_VOLUME
	EOF
}

read_env() {
	if [ -f "$GITOBLD_ENV" ]; then
		. $GITOBLD_ENV
	fi

	export ABUILD_CONTAINER
	export APK_SERVER_CONTAINER
}

GITOBLD_ENV=${GITOBLD_ENV:-./.gitobld_env}

if [ "$1" = '-w' ]; then
	save_env
else
	read_env
fi

